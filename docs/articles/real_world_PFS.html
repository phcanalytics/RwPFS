<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real-world Progression-free Survival (rwPFS) • RwPFS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Real-world Progression-free Survival (rwPFS)">
<meta property="og:description" content="RwPFS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RwPFS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/real_world_PFS.html">Real-world Progression-free Survival (rwPFS)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/phcanalytics/RwPFS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Real-world Progression-free Survival (rwPFS)</h1>
                        <h4 data-toc-skip class="author">Michael Bretscher</h4>
            
            <h4 data-toc-skip class="date">2022-05-13</h4>
      
      
      <div class="hidden name"><code>real_world_PFS.Rmd</code></div>

    </div>

    
    
<p><em>The background section gives some general context on using real-world Progression-free Survival as endpoint in oncology - if you just want to know about using the RwPFS package feel free to skip ahead to <a href="#getting-started-with-rwpfs">Getting started with RwPFS</a></em></p>
<p><br><em>For a detailed discussion of the rwPFS endpoint see <span class="citation">Mhatre (2021)</span></em> <br><br></p>
<div class="section level1">
<h1 id="background-on-rwpfs">Background on rwPFS<a class="anchor" aria-label="anchor" href="#background-on-rwpfs"></a>
</h1>
<p>Progression-free Survival (PFS) is a commonly used time-to event endpoint in cancer trials. It is defined as the first event of either death or progression.</p>
<p>An important difference between the PFS and Overall Survival (OS, time to death) endpoints is that PFS requires close follow-up of patients, whereas OS does not. This is because death is a one-time event, and whenever a patient is contacted alive, we know that death had not occurred previously. This is not the case when looking at progression, hence patients must be closely monitored.</p>
<p><br></p>
<p><strong>The mechanisms of data-collection differ between real-world data &amp; clinical trials <span class="citation">(Mhatre 2021)</span>:</strong></p>
<ul>
<li><p>In clinical trials, tumor assessments are scheduled at regular intervals, and progression is assessed using standardized criteria. The reason for collecting PFS data in clinical trials is to measure treatment efficacy. Transparency and consistency of the data collection process are emphasized.</p></li>
<li><p>In routine health care, there is commonly no protocol and no regularly scheduled tumor assessments. Progression may or may not be assessed following standard criteria - this is generally not known. Physicians may measure progression mainly in order to make treatment decisions, not to statistically compare the effectiveness of different treatments. In addition, transparency and consistency of data collection are likely to be less important objectives than cost considerations or minimization of discomfort for the patient (e.g. by avoiding unnecessary scans).</p></li>
</ul>
<p><br></p>
<p>Because of these differences, it appears sensible to speak of “real-world PFS” (<strong>rwPFS</strong>) and to treat it as a separate endpoint, distinct from trial PFS. However, due to the highly similar definitions of rwPFS and PFS, it is possible that the two endpoints may be <em>equivalent</em>, meaning they essentially lead to the same result and could be used to compare effectivness of treatments both within a particular real-world data source as well as between trial and real-world data.</p>
<p><br></p>
<blockquote>
<p>Whether or not <strong>PFS</strong> and <strong>rwPFS</strong> endpoints are <strong>equivalent</strong> and can be used for comparing drug efficacy across two data sets (real-world and clinical trial) may depend on type of cancer, drug category, real-world database, and other factors. While attempts should be made to understand and ensure quality of data collection in the real-world data, this will likely never be perfect. Consequently, empirical confirmation of the equivalence of rwPFS and PFS will be needed. This can be done by replicating trial arms and comparing rwPFS and trial PFS outcomes <span class="citation">(Mhatre 2021; Ton 2021)</span>, across indications and drug categories.</p>
</blockquote>
<div class="section level2">
<h2 id="algorithm-for-calculating-rwpfs-using-flatiron-data">Algorithm for calculating rwPFS using Flatiron data<a class="anchor" aria-label="anchor" href="#algorithm-for-calculating-rwpfs-using-flatiron-data"></a>
</h2>
<p>Figure 1 in <span class="citation">Mhatre (2021)</span> illustrates the important elements required for calculating a rwPFS endpoint:</p>
<ul>
<li><p>the start date (baseline)</p></li>
<li><p>the date up to which progression was abstracted from clinical notes</p></li>
<li><p>the dates of any progression events of interest</p></li>
<li><p>the date of death, if present</p></li>
<li><p>the date of a patient’s last structured activity in the database</p></li>
<li><p>the presence of potential visit gaps (not shown), indicating that the patient may not have been followed for progression due to prolonged absence from the clinic (e.g. &gt;90d).</p></li>
<li><p>a time window after the end of progression follow-up where death events are to be captured. This is required to avoid informative censoring because it is not uncommon that data on progression ceases to be collected shortly before death of a patient. If the time window is too small, there will almost exclusively be progression events. If the window is too large, more deaths are captured, but at the same time the risk of missing any progression events increases. Therefore, a pragmatic choice will have to be made. More on this point later.</p></li>
</ul>
<p><br> The RwPFS package uses the algorithm below to calucate rwPFS endpoints. <br></p>
<blockquote>
<p><strong>A general algorithm for calculation of rwPFS consists of the following steps:</strong></p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Determine the period of continuous progression follow-up.</strong></p>
<p>It begins at baseline and ends at one of the following, whichever occurs first:</p>
<ul>
<li><p>the start of a long gap between visits (e.g. &gt;90d)</p></li>
<li><p>the date of last progression abstraction</p></li>
<li><p>the date of last structured activity in the database</p></li>
</ul>
</li>
<li>
<p><strong>Determine the type of rwPFS event</strong>, in this order:</p>
<ul>
<li><p>“Progression,” if an event occurs during the follow-up period</p></li>
<li><p>“Death,” if it occurs within the specified time window after end of follow-up</p></li>
<li><p>“Censoring” otherwise</p></li>
</ul>
</li>
<li>
<p><strong>Create rwPFS variables </strong></p>
<ul>
<li><p>record a rwPFS event in case of death or progression event types</p></li>
<li><p>otherwise, censor the patient at the end of progression follow-up</p></li>
<li><p>calculate the time from baseline to event or censoring</p></li>
</ul>
</li>
</ol>
</blockquote>
</div>
<div class="section level2">
<h2 id="there-are-several-possible-rwpfs-definitions">There are several possible rwPFS definitions<a class="anchor" aria-label="anchor" href="#there-are-several-possible-rwpfs-definitions"></a>
</h2>
<p><strong>Multiple possible definitions of rwPFS can be specified based on the elements mentioned above:</strong></p>
<ul>
<li><p><strong>different subsets of progression events could be used</strong>, e.g. only radiographically confirmed progression events, or only progression events that occur more than 14 days after baseline</p></li>
<li>
<p><strong>different possibilities exist to handle changes in the line of therapy (LoT):</strong> one could either</p>
<ul>
<li><p>follow the patient for progression into a subsequent LoT if no progression has occurred, or..</p></li>
<li><p>censor the patient at the start of a subsequent LoT, or..</p></li>
<li><p>impute a progression event at the start of a subsequent LoT (following the clinical logic that LoT is anchored to progression)</p></li>
</ul>
</li>
<li>
<p><strong>different choices are possible for the length of the time window to capture death events</strong></p>
<ul>
<li><p>the aim is to capture most of - and only - the death events correlated in time with the end of follow-up.</p></li>
<li><p>this is reminiscent of informative censoring - except in this case events occurring after the <em>end of follow-up</em> can be accessed and potentially included.</p></li>
<li><p>reasonable values for the length of the time window can be argued based on comparison with data collection in trials, or - in a data-driven way by inspecting the drop in the number of death events as the window is being extended (see best practices below). For a detailed discussion see <span class="citation">Mhatre (2021)</span></p></li>
<li><p>ultimately, any choice will remain arbitrary to some extent.</p></li>
</ul>
</li>
<li><p>it seems reasonable to ensure gapless progression follow-up, but <strong>the choice of a maximally tolerable gap length between visits remains arbitrary</strong>. A commonly used value is 90 days, however, without a very strong rationale.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="best-practices-to-support-the-emergence-of-consensus-definitions">Best practices to support the emergence of consensus definitions<a class="anchor" aria-label="anchor" href="#best-practices-to-support-the-emergence-of-consensus-definitions"></a>
</h2>
<p>As outlined above, there is a range of possible definitions of rwPFS. To determine which of these are most closely mimicking clinical trial PFS requires discussions with subject matter experts, and it is possible that different conclusions may be reached depending on indication, drug category, analysis objective, or other factors. From our experience in aNSCLC <span class="citation">(Mhatre 2021; Ton 2021)</span> several definitions - not only one - remain viable options even after discussion with experts, and eventually a pragmatic choice must be made. Despite a desire for standardization, we reached the conclusion that defining a single standard is not helpful given the current state of knowledge, and that instead we should promote best practices that support the emergence of - preferably rather few - standard definitions via publications in the scientific literature.</p>
<p><br></p>
<p>To promote the emergence of standard rwPFS definitions and comparability across analyses we propose the following best practices: <br><br></p>
<blockquote>
<p><strong>Proposed best practices when using rwPFS</strong></p>
<ol style="list-style-type: decimal">
<li><p>Check if there is already a commonly used rwPFS definition in analyses similar to yours.</p></li>
<li><p>Discuss sensible rwPFS definitions with subject matter experts.</p></li>
<li><p>If there is already a commonly used rwPFS definition that passes the expert test, try to use it.</p></li>
<li><p>If you have reasons to use a different definition, do so and try to explain your choice</p></li>
<li><p><strong>Be transparent about the exact definition you’re using</strong></p></li>
<li><p><strong>Explore a range of sensible alternative definitions and report key descriptors to show how rwPFS definition affects the conclusions of the analysis</strong></p></li>
</ol>
</blockquote>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="getting-started-with-rwpfs">Getting started with RwPFS<a class="anchor" aria-label="anchor" href="#getting-started-with-rwpfs"></a>
</h1>
<p>To start, we will add a rwPFS variable to a simulated dataset. For simplicity, we will use the rwPFS definition used in <span class="citation">Mhatre (2021)</span> and <span class="citation">Ton (2021)</span>:</p>
<ul>
<li><p><strong>Use all progression events except where “pseudoprogression mentioned”</strong> (not only events based on radiographic evidence, and we don’t discard progression events occurring within 2 weeks after baseline)</p></li>
<li><p><strong>Follow patients for progression into subsequent lines of treatment</strong> (do not censor them at start of new line, do not impute progression at line change)</p></li>
<li><p><strong>Include death events occurring &lt;30d after end of progression follow-up</strong></p></li>
<li><p><strong>Censor individuals if there is a visit gap &gt; 90 days during follow-up</strong></p></li>
<li><p><strong>Use the first progression event when there are several</strong></p></li>
</ul>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Load the required libraries</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RwPFS</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html" class="external-link">survminer</a></span><span class="op">)</span></code></pre></div>
<p>The <em>RwPFS</em> package contains <em>simprog</em>, a simulated dataset with progression information and other variables required to compute a rwPFS endpoint:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simprog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 1,000</span>
<span class="co">#&gt; Columns: 10</span>
<span class="co">#&gt; $ patientid                             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1…</span>
<span class="co">#&gt; $ baseline_date                         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-01, 2010-01-01, 2010-01…</span>
<span class="co">#&gt; $ last_activity_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-08-29, 2011-07-14, 2012-04…</span>
<span class="co">#&gt; $ death_date                            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-11-19, NA, 2012-05-15, 201…</span>
<span class="co">#&gt; $ visit_gap_start_date                  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, NA, NA, NA, NA, NA,…</span>
<span class="co">#&gt; $ last_progression_abstraction_date     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-08-29, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ progression_date_all_events           <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, NA, 2010-08-24, 201…</span>
<span class="co">#&gt; $ progression_date_discard_le_14d       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, NA, 2010-08-24, 201…</span>
<span class="co">#&gt; $ progression_date_radiographic_only    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, NA, 2010-08-24, 201…</span>
<span class="co">#&gt; $ progression_date_no_pseudoprogression <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, NA, 2010-08-24, 201…</span></code></pre></div>
<p>The <em>patientid</em>, <em>baseline_date</em>, <em>last_activity_date</em> &amp; <em>death_date</em> columns are self-explanatory. <em>visit_gap_start_date</em> indicates the date of the last visit before a longer gap in visits (e.g. 90 days) and is <em>NA</em> if no such gap occurs. The date up to which progression information is available for a particular patient is indicated in <em>last_progression_abstraction_date</em>. Lastly, there are a number of columns indicating the date of progression, with all except <em>progression_date_all_events</em> considering only a specific subset of progression events - we’ll talk about that later.</p>
</div>
<div class="section level2">
<h2 id="adding-real-world-pfs">Adding real-world PFS<a class="anchor" aria-label="anchor" href="#adding-real-world-pfs"></a>
</h2>
<p>For a start, we’ll keep things simple and use the <em>progression_date_all_events</em> variable, discarding the other progression date columns. A call to <code>calc_rwPFS</code>, mapping column names in our particular dataset to the function arguments, will add PFS-related variables to the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">simprog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_all_events"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span></code></pre></div>
<p>This added the following additional columns to the dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"rwPFS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 1,000</span>
<span class="co">#&gt; Columns: 6</span>
<span class="co">#&gt; $ rwPFS_all_events_eof_date   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, 2010-10-05, 2010-10-16, 2010-…</span>
<span class="co">#&gt; $ rwPFS_all_events_event_type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Progression", …</span>
<span class="co">#&gt; $ rwPFS_all_events_date       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08-24, 2010-…</span>
<span class="co">#&gt; $ rwPFS_all_events_days       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 96, 105, 30, 122…</span>
<span class="co">#&gt; $ rwPFS_all_events_event      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, …</span>
<span class="co">#&gt; $ rwPFS_all_events_months     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392, 0.9856263…</span></code></pre></div>
<p>The names of these columns are composed of “rwPFS” followed by the <em>label</em> specified in the call to <code>calc_rwPFS</code>, followed by the type of variable: <em>eof_date</em> marking the end of the period of continuous progression follow-up, the <em>type</em> &amp; <em>date</em> of the rwPFS event, as well as the <em>event</em> (or censoring) &amp; time to event variables (in <em>days</em> or <em>months</em>).</p>
<p>Let’s plot the Kaplan-Meier curve for rwPFS</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/survminer/man/surv_fit.html" class="external-link">surv_fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">rwPFS_all_events_months</span>, <span class="va">rwPFS_all_events_event</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">ggsurvplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> </code></pre></div>
<p><img src="real_world_PFS_files/figure-html/unnamed-chunk-6-1.png" width="1600" style="display: block; margin: auto;"></p>
<p>This doesn’t look too bad… congratulations, you’ve mastered the basics of using the RwPFS package!</p>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="comparison-of-multiple-rwpfs-definitions">Comparison of multiple rwPFS definitions<a class="anchor" aria-label="anchor" href="#comparison-of-multiple-rwpfs-definitions"></a>
</h1>
<p>As mentioned before, there is more than one way of defining rwPFS. Often, the differences between definitions will be small, yet for the sake of scientific rigor it would be great to verify how large these differences are.. conducting a full sensitivity analysis for each and every rwPFS definition, however, seems overkill.. so what do we do?</p>
<p><br></p>
<p>Ideally, we’d have a concise summary table, where readers could verify at one glance what the impact of varying the endpoint definition would be. This is what we’ll do next..</p>
<p><br></p>
<div class="section level2">
<h2 id="using-different-subsets-of-progression-events">Using different subsets of progression events<a class="anchor" aria-label="anchor" href="#using-different-subsets-of-progression-events"></a>
</h2>
<p>First, let’s calculate additional rwPFS endpoints, across a range of “reasonable” definitions:</p>
<ul>
<li><p><code>discard_le_14d</code> where all progression events within 14 days of baseline are discarded</p></li>
<li><p><code>radiographic_only</code> where only radiographically confirmed progression events are considered</p></li>
<li><p><code>no_pseudoprogression</code> where so-called “pseudo-progression” events are discarded</p></li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">simprog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  
  <span class="co">#Start with the "_all_events" rwPFS endpoint, as in the simple example above</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_all_events"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="co"># Add "discard_le_14d" rwPFS</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_discard_le_14d"</span>,
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_discard_le_14d"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
  
  <span class="co"># Add "radiographic_only" rwPFS</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_no_pseudoprogression"</span>,
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_radiographic_only"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  

  <span class="co"># Add "no_pseudoprogression" rwPFS</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_radiographic_only"</span>,
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_no_pseudoprogression"</span>                  <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> </code></pre></div>
<p><br></p>
<p>We also want to look at rwPFS definitions where we don’t consider visit gaps. This can be done by supplying an <em>all_na</em> date column to calc_rwPFS as the column containing the dates of visit gaps:</p>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    <span class="co">#adding an all_na column </span>
    all_na <span class="op">=</span> <span class="cn">NA_character_</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>

  <span class="co"># Add "ignore_visit_gaps" rwPFS</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"all_na"</span>,                 <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_ignore_visit_gaps"</span>                     <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span>   
  </code></pre></div>
<p><br></p>
<p><em>On a side note, supplying a custom date column as <em>.visit_gap_start_date</em> can e.g. be used to trick <code>calc_rwPFS</code> into censoring observations early (e.g. at a change of the line of therapy). Similarly, progression events can be imputed (e.g. at a line of therapy change) by creating a custom <em>.progression_date</em> column.</em></p>
<p><br></p>
<p>Now we have a dataset that contains variables for all the different rwPFS endpoints we’ve defined, using the labels as in-fixes in the variable names:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"rwPFS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 1,000</span>
<span class="co">#&gt; Columns: 30</span>
<span class="co">#&gt; $ rwPFS_all_events_eof_date             <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ rwPFS_all_events_event_type           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Prog…</span>
<span class="co">#&gt; $ rwPFS_all_events_date                 <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08…</span>
<span class="co">#&gt; $ rwPFS_all_events_days                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 96, 10…</span>
<span class="co">#&gt; $ rwPFS_all_events_event                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,…</span>
<span class="co">#&gt; $ rwPFS_all_events_months               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392,…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_eof_date         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_event_type       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Prog…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_date             <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_days             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 96, 10…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_event            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,…</span>
<span class="co">#&gt; $ rwPFS_discard_le_14d_months           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392,…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_eof_date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_event_type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Prog…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_days          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 96, 10…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_event         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,…</span>
<span class="co">#&gt; $ rwPFS_radiographic_only_months        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392,…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_eof_date   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-04-07, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_event_type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Prog…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_date       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_days       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 173, 1…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_event      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0,…</span>
<span class="co">#&gt; $ rwPFS_no_pseudoprogression_months     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392,…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_eof_date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-08-29, 2010-10-05, 2010-10…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_event_type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Progression", "Censored", "Prog…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2010-01-27, 2010-10-05, 2010-08…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_days          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 26, 277, 235, 30, 31, 69, 96, 10…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_event         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,…</span>
<span class="co">#&gt; $ rwPFS_ignore_visit_gaps_months        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8542094, 9.1006160, 7.7207392,…</span></code></pre></div>
<p>Let’s compare these different rwPFS endpoints using <code>compare_rwPFS</code> to see if rwPFS outcomes are sensitive to the exact endpoint definition:</p>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/compare_rwPFS.html">compare_rwPFS</a></span><span class="op">(</span>
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>                         <span class="co">#Specify the rwPFS labels to be tabulated (in the desired order)</span>
      <span class="st">"_all_events"</span>,
      <span class="st">"_discard_le_14d"</span>,
      <span class="st">"_radiographic_only"</span>,
      <span class="st">"_no_pseudoprogression"</span>,
      <span class="st">"_ignore_visit_gaps"</span>
    <span class="op">)</span>,
    .reference <span class="op">=</span> <span class="st">"_all_events"</span>,
    .incremental_deaths_column <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning in compare_rwPFS(., .labels = c("_all_events", "_discard_le_14d", : 8</span>
<span class="co">#&gt; Patients with missing rwPFS were found and removed</span>
<span class="co">#&gt; Warning: `select_()` was deprecated in dplyr 0.7.0.</span>
<span class="co">#&gt; Please use `select()` instead.</span>
<span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="21%">
<col width="10%">
<col width="12%">
<col width="6%">
<col width="14%">
<col width="17%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="left">rwPFS definition</th>
<th align="right">Censoring</th>
<th align="right">Progression</th>
<th align="right">Death</th>
<th align="right">Percent death</th>
<th align="left">KM median</th>
<th align="left">Hazard ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">All events</td>
<td align="right">474</td>
<td align="right">345</td>
<td align="right">173</td>
<td align="right">33.4</td>
<td align="left">5.65 (5.06-6.41)</td>
<td align="left">1 (reference)</td>
</tr>
<tr class="even">
<td align="left">Discard le 14d</td>
<td align="right">500</td>
<td align="right">313</td>
<td align="right">179</td>
<td align="right">36.4</td>
<td align="left">6.05 (5.32-6.93)</td>
<td align="left">0.91 (0.81-1.04)</td>
</tr>
<tr class="odd">
<td align="left">Radiographic only</td>
<td align="right">475</td>
<td align="right">343</td>
<td align="right">174</td>
<td align="right">33.7</td>
<td align="left">5.68 (5.06-6.47)</td>
<td align="left">0.99 (0.88-1.12)</td>
</tr>
<tr class="even">
<td align="left">No pseudoprogression</td>
<td align="right">489</td>
<td align="right">328</td>
<td align="right">175</td>
<td align="right">34.8</td>
<td align="left">6.01 (5.29-6.74)</td>
<td align="left">0.95 (0.84-1.07)</td>
</tr>
<tr class="odd">
<td align="left">Ignore visit gaps</td>
<td align="right">448</td>
<td align="right">365</td>
<td align="right">179</td>
<td align="right">32.9</td>
<td align="left">5.65 (5.06-6.34)</td>
<td align="left">1 (0.88-1.12)</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>The obtained table gives an overview across the rwPFS definitions we’re considering. It compares the no. of censoring-, progression- and death events, as well as the percentage of rwPFS events (death and progression combined) that are death.</p>
<p>Kaplan-Meier median and hazard ratio relative to the reference definition give an impression of how big the impact on corresponding analysis outcomes would be. Note that to obtain the hazard ratio, a cox regression was fitted to data of twice the same patients but with different endpoints. Since the Cox model assumes the data from two compared groups to be independent, this is a bit of a stretch. The HR should therefore cautiously be interpreted as a crude indication of expected impact on any HR analyses, in order to avoid doing full senstivity analyses with all rwPFS definitions.</p>
<p>Jointly, these outputs allow a discussion of the potential impact of varying the rwPFS definition on rwPFS outcomes. In the present case, however, the underlying data are fabricated, hence such a discussion would not be very insightful. For a real-life example of using <code>compare_rwPFS</code> please refer to <span class="citation">Mhatre (2021)</span>.</p>
<p><br></p>
<p>Maybe you noticed: when calling <code>compare_rwPFS</code> there was a warning about 8 patients having missing rwPFS. These are usually introduced by <code>calc_rwPFS</code> for good reasons: either if any of the required input dates are missing, if the order of dates does not make sense (e.g. death date before baseline, perhaps due to coarse granularity of death date information), etc.</p>
<p>A quick check reveals that indeed the patients with (any type of) missing rwPFS have either zero days follow-up, or a progression event exactly at baseline. It’s generally a good idea to hand-check patients where the rwPFS event is of type “missing,” as this is what <code>calc_rwPFS</code> generates if the input data do not allow calculation of an rwPFS endpoint.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter_all.html" class="external-link">filter_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"_event_type"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_vars.html" class="external-link">any_vars</a></span><span class="op">(</span><span class="va">.</span> <span class="op">==</span> <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="3%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="3%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="0%">
<col width="2%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="2%">
</colgroup>
<thead><tr class="header">
<th align="right">patientid</th>
<th align="left">baseline_date</th>
<th align="left">last_activity_date</th>
<th align="left">death_date</th>
<th align="left">visit_gap_start_date</th>
<th align="left">last_progression_abstraction_date</th>
<th align="left">progression_date_all_events</th>
<th align="left">progression_date_discard_le_14d</th>
<th align="left">progression_date_radiographic_only</th>
<th align="left">progression_date_no_pseudoprogression</th>
<th align="left">rwPFS_all_events_eof_date</th>
<th align="left">rwPFS_all_events_event_type</th>
<th align="left">rwPFS_all_events_date</th>
<th align="right">rwPFS_all_events_days</th>
<th align="right">rwPFS_all_events_event</th>
<th align="right">rwPFS_all_events_months</th>
<th align="left">rwPFS_discard_le_14d_eof_date</th>
<th align="left">rwPFS_discard_le_14d_event_type</th>
<th align="left">rwPFS_discard_le_14d_date</th>
<th align="right">rwPFS_discard_le_14d_days</th>
<th align="right">rwPFS_discard_le_14d_event</th>
<th align="right">rwPFS_discard_le_14d_months</th>
<th align="left">rwPFS_radiographic_only_eof_date</th>
<th align="left">rwPFS_radiographic_only_event_type</th>
<th align="left">rwPFS_radiographic_only_date</th>
<th align="right">rwPFS_radiographic_only_days</th>
<th align="right">rwPFS_radiographic_only_event</th>
<th align="right">rwPFS_radiographic_only_months</th>
<th align="left">rwPFS_no_pseudoprogression_eof_date</th>
<th align="left">rwPFS_no_pseudoprogression_event_type</th>
<th align="left">rwPFS_no_pseudoprogression_date</th>
<th align="right">rwPFS_no_pseudoprogression_days</th>
<th align="right">rwPFS_no_pseudoprogression_event</th>
<th align="right">rwPFS_no_pseudoprogression_months</th>
<th align="left">all_na</th>
<th align="left">rwPFS_ignore_visit_gaps_eof_date</th>
<th align="left">rwPFS_ignore_visit_gaps_event_type</th>
<th align="left">rwPFS_ignore_visit_gaps_date</th>
<th align="right">rwPFS_ignore_visit_gaps_days</th>
<th align="right">rwPFS_ignore_visit_gaps_event</th>
<th align="right">rwPFS_ignore_visit_gaps_months</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">15</td>
<td align="left">2010-01-01</td>
<td align="left">2010-08-22</td>
<td align="left">2010-09-16</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">461</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">480</td>
<td align="left">2010-01-01</td>
<td align="left">2012-03-27</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">2010-03-26</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-03-26</td>
<td align="left">Censored</td>
<td align="left">2010-03-26</td>
<td align="right">84</td>
<td align="right">0</td>
<td align="right">2.759754</td>
</tr>
<tr class="even">
<td align="right">538</td>
<td align="left">2010-01-01</td>
<td align="left">2011-02-19</td>
<td align="left">2011-04-11</td>
<td align="left">NA</td>
<td align="left">2010-01-27</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-27</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-27</td>
<td align="left">Censored</td>
<td align="left">2010-01-27</td>
<td align="right">26</td>
<td align="right">0</td>
<td align="right">0.8542094</td>
<td align="left">2010-01-27</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-27</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-27</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">630</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">666</td>
<td align="left">2010-01-01</td>
<td align="left">2010-07-10</td>
<td align="left">2010-08-30</td>
<td align="left">NA</td>
<td align="left">2010-07-10</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">2010-07-10</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-07-10</td>
<td align="left">Censored</td>
<td align="left">2010-07-10</td>
<td align="right">190</td>
<td align="right">0</td>
<td align="right">6.2422998</td>
<td align="left">2010-07-10</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-07-10</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-07-10</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">802</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-18</td>
<td align="left">2010-01-23</td>
<td align="left">NA</td>
<td align="left">2010-01-18</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-18</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-18</td>
<td align="left">Death</td>
<td align="left">2010-01-23</td>
<td align="right">22</td>
<td align="right">1</td>
<td align="right">0.7227926</td>
<td align="left">2010-01-18</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-01-18</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-01-18</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">867</td>
<td align="left">2010-01-01</td>
<td align="left">2010-06-17</td>
<td align="left">2010-07-12</td>
<td align="left">NA</td>
<td align="left">2010-04-21</td>
<td align="left">2010-01-01</td>
<td align="left">NA</td>
<td align="left">2010-01-01</td>
<td align="left">2010-01-01</td>
<td align="left">2010-04-21</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-04-21</td>
<td align="left">Censored</td>
<td align="left">2010-04-21</td>
<td align="right">110</td>
<td align="right">0</td>
<td align="right">3.6139630</td>
<td align="left">2010-04-21</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">2010-04-21</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">2010-04-21</td>
<td align="left">Missing</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="comparing-different-time-windows-for-capturing-death-events">Comparing different time windows for capturing death events<a class="anchor" aria-label="anchor" href="#comparing-different-time-windows-for-capturing-death-events"></a>
</h2>
<p>A remaining question is how long the time window for capturing deaths should be after the end of progression follow-up. We’ve chosen 30 days above, as discussed in <span class="citation">Mhatre (2021)</span> and <span class="citation">Ton (2021)</span>, but without a very strong rationale.</p>
<p><br></p>
<p>There may not be one single “right” value for the size of this window. However, one way of verifying if a given value is sensible is to vary the length of this window and check how many additional deaths are captured when extending it. The idea here is that we want to capture most of the deaths that are correlated with the end of progression follow-up, meaning they happen shortly after. In addition, we want to keep the window as small as possible to minimize the risk of missing progression events happening during this period. A pragmatic choice may be made that reconciles these opposing objectives as well as possible.</p>
<p><br> We can calculate rwPFS endpoints with varying window lengths as follows:</p>
<p><br></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">simprog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  
  <span class="co">#Start with the "_all_events" rwPFS endpoint, as in the simple example above</span>
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">0</span>,                           <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_0d_window"</span>                             <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">10</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_10d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">20</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_20d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">30</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_30d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">40</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_40d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">50</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_50d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">60</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_60d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">70</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_70d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">80</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_80d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  
  <span class="fu"><a href="../reference/calc_rwPFS.html">calc_rwPFS</a></span><span class="op">(</span>
    .start_date <span class="op">=</span> <span class="st">"baseline_date"</span>,                    <span class="co">#baseline date for measuring time-to-event</span>
    .visit_gap_start_date <span class="op">=</span> <span class="st">"visit_gap_start_date"</span>,   <span class="co">#the start date of any gap in visits &gt;90 days  </span>
    .last_progression_abstraction_date <span class="op">=</span> <span class="st">"last_progression_abstraction_date"</span>, 
    .progression_date <span class="op">=</span> <span class="st">"progression_date_all_events"</span>,<span class="co">#the date of progression (none: NA)</span>
    .last_activity_date <span class="op">=</span> <span class="st">"last_activity_date"</span>,       <span class="co">#the date of last activity in the database</span>
    .death_date <span class="op">=</span> <span class="st">"death_date"</span>,                       <span class="co">#the date of death</span>
    .death_window_days <span class="op">=</span> <span class="fl">90</span>,                          <span class="co">#include death events &lt;30d after progression EOF</span>
    .max_follow_up_days <span class="op">=</span> <span class="cn">Inf</span>,                        <span class="co">#censor patients after a maximum time. </span>
    .label <span class="op">=</span> <span class="st">"_90d_window"</span>                            <span class="co">#Label for this rwPFS endpoint (for comparisons)</span>
  <span class="op">)</span>
  </code></pre></div>
<p><br></p>
<p>and then compare them like before, but this time adding an ‘incremental deaths’ column to the output, indicating how many additional deaths are captured by extending the window by 10 more days</p>
<p><br></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/compare_rwPFS.html">compare_rwPFS</a></span><span class="op">(</span>
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">*</span><span class="fl">10</span>, <span class="st">"d_window"</span><span class="op">)</span>,<span class="co">#Specify the rwPFS labels to be tabulated (in the desired order)</span>
    .reference <span class="op">=</span> <span class="st">"_30d_window"</span>,
    .incremental_deaths_column <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning in compare_rwPFS(., .labels = paste0("_", 0:9 * 10, "d_window"), : 8</span>
<span class="co">#&gt; Patients with missing rwPFS were found and removed</span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="8%">
<col width="10%">
<col width="5%">
<col width="16%">
<col width="12%">
<col width="15%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">rwPFS definition</th>
<th align="right">Censoring</th>
<th align="right">Progression</th>
<th align="right">Death</th>
<th align="right">Incremental deaths</th>
<th align="right">Percent death</th>
<th align="left">KM median</th>
<th align="left">Hazard ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0d window</td>
<td align="right">643</td>
<td align="right">345</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="right">1.1</td>
<td align="left">8.15 (7.52-9)</td>
<td align="left">0.69 (0.6-0.79)</td>
</tr>
<tr class="even">
<td align="left">10d window</td>
<td align="right">576</td>
<td align="right">345</td>
<td align="right">71</td>
<td align="right">67</td>
<td align="right">17.1</td>
<td align="left">7.16 (6.31-7.98)</td>
<td align="left">0.82 (0.72-0.93)</td>
</tr>
<tr class="odd">
<td align="left">20d window</td>
<td align="right">518</td>
<td align="right">345</td>
<td align="right">129</td>
<td align="right">58</td>
<td align="right">27.2</td>
<td align="left">6.14 (5.49-7.1)</td>
<td align="left">0.92 (0.82-1.05)</td>
</tr>
<tr class="even">
<td align="left">30d window</td>
<td align="right">474</td>
<td align="right">345</td>
<td align="right">173</td>
<td align="right">44</td>
<td align="right">33.4</td>
<td align="left">5.65 (5.06-6.41)</td>
<td align="left">1 (reference)</td>
</tr>
<tr class="odd">
<td align="left">40d window</td>
<td align="right">445</td>
<td align="right">345</td>
<td align="right">202</td>
<td align="right">29</td>
<td align="right">36.9</td>
<td align="left">5.32 (4.9-6.05)</td>
<td align="left">1.05 (0.93-1.18)</td>
</tr>
<tr class="even">
<td align="left">50d window</td>
<td align="right">422</td>
<td align="right">345</td>
<td align="right">225</td>
<td align="right">23</td>
<td align="right">39.5</td>
<td align="left">5.19 (4.8-5.88)</td>
<td align="left">1.08 (0.96-1.22)</td>
</tr>
<tr class="odd">
<td align="left">60d window</td>
<td align="right">408</td>
<td align="right">345</td>
<td align="right">239</td>
<td align="right">14</td>
<td align="right">40.9</td>
<td align="left">5.06 (4.7-5.68)</td>
<td align="left">1.1 (0.98-1.24)</td>
</tr>
<tr class="even">
<td align="left">70d window</td>
<td align="right">393</td>
<td align="right">345</td>
<td align="right">254</td>
<td align="right">15</td>
<td align="right">42.4</td>
<td align="left">5.06 (4.67-5.62)</td>
<td align="left">1.12 (1-1.26)</td>
</tr>
<tr class="odd">
<td align="left">80d window</td>
<td align="right">380</td>
<td align="right">345</td>
<td align="right">267</td>
<td align="right">13</td>
<td align="right">43.6</td>
<td align="left">5.03 (4.63-5.49)</td>
<td align="left">1.14 (1.01-1.28)</td>
</tr>
<tr class="even">
<td align="left">90d window</td>
<td align="right">371</td>
<td align="right">345</td>
<td align="right">276</td>
<td align="right">9</td>
<td align="right">44.4</td>
<td align="left">5.03 (4.63-5.49)</td>
<td align="left">1.14 (1.02-1.29)</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Similarly as before, we are now able to compare different rwPFS definitions at a glance and examine the impact of extending the time window for capturing death events.</p>
<p><br></p>
<p>Please note that this is only simulated data and does not <em>really</em> allow for a discussion of this issue. The following is just meant as an illustration, although the pattern found here mirrors quite closely the situation in real patient data as discussed in <span class="citation">Mhatre (2021)</span>.</p>
<p>From these outputs one could argue for a 30 day time window as follows: first, a time-window of 0 days corresponds to a substantial HR difference compared to the reference (30d window). This indicates that it may indeed be important to capture death events occurring after end of progression follow-up. We can also see, that the effect of extending the window from 30d to 90d changes the HR by comparatively smaller amounts, suggesting that the effect of extending the window further is diminishing rapidly. This is reflected in the ‘Incremental deaths’ column as well: for the each 10-day period up to 30 days we capture approximately between 44 &amp; 67 additional deaths, with this number dropping rapidly thereafter. It is hard to tell where exactly the cutoff should be made - but one could say that 30d to 60d is reasonable since most censoring-related deaths appear to be captured, and further extension has negligible impact on hazard ratios.</p>
<p><br></p>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-rwPFS_OAK" class="csl-entry">
Mhatre. 2021. <span>“Replicating Progression-Free Survival in the OAK Trial Using Real-World Data.”</span> <em>In Preparation</em>.
</div>
<div id="ref-EC_impowers" class="csl-entry">
Ton. 2021. <span>“Replication of Overall Survival, Progression Free Survival and Response in Chemotherapy Arms of First Line Non-Small Cell Lung Cancer Trials Using Real-World Data External Controls.”</span> <em>In Preparation</em>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Bretscher, Shanmugasundaram Prabhu, Nandi Kalyan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
